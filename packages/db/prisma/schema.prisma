// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
  importFileExtension = "ts"
}

datasource db {
  provider = "postgresql"
}


enum TradeSide {
  BUY
  SELL
}


model User{
  id    Int @id @default(autoincrement())
  // @db.Uuid ensures the database stores UUID efficiently using its native UUID type. If we don't use @db.Uuid, DB will store UUID as a string, which is less efficient.
  uuid String @unique @default(uuid()) @db.Uuid 
  name String? 
  email String @unique
  emailVerified DateTime?
  avatarUrl String?
  password String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  accounts Account[]
  trades Trade[]
  sessions Session[]
}

model Session {
  id String @id @default(cuid())
  sessionToken String @unique
  userId Int
  expries DateTime
  user User @relation(fields:[userId], references:[id], onDelete:Cascade)

  @@index([userId])
}

model Trade {
  id        Int      @id @default(autoincrement())
  uuid      String   @unique @default(uuid()) @db.Uuid
  userId    Int
  symbol    String  
  side      TradeSide
  quantity  Int
  price     Decimal  @db.Decimal(10, 2)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  @@index([userId])
  @@index([symbol])
}

model Account {
  id String @id @default(cuid())
  userId Int
  type String
  provider String
  providerAccountId String
  refresh_token String? @db.Text
  access_token String @db.Text
  expires_at Int?
  token_type String?
  scope String?
  id_token String? @db.Text
  session_state String?

  user User @relation(fields:[userId], references:[id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@index([userId])
}